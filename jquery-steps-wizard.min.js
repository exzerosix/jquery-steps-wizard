/*!
 * JQuery Steps Wizard - A wizard form plugin for jQuery
 * 
 * @version        1.0.0
 * @since          2026-02-05
 * @author         Joey Sauva
 * 
 * Copyright (c) 2026 Joey Sauva
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

!function(t){var e={init:function(i){return this.each((function(){var a=t.extend({},t.fn.jsteps.defaults,i),s=t(this).data("options",a),n=s.attr("id");n||(n="jsteps-"+t("."+s.attr("class")).index(this),s.attr("id",n)),s.data("skippedSteps",a.skipSteps||[]),e._build.call(s)}))},setSkipSteps:function(t){return this.data("skippedSteps",t),e._updateTabStates.call(this),this},skipStep:function(t){var i=this.data("skippedSteps")||[];return-1===i.indexOf(t)&&(i.push(t),this.data("skippedSteps",i),e._updateTabStates.call(this)),this},unskipStep:function(t){var i=this.data("skippedSteps")||[],a=i.indexOf(t);return-1!==a&&(i.splice(a,1),this.data("skippedSteps",i),e._updateTabStates.call(this)),this},clearSkipSteps:function(){return this.data("skippedSteps",[]),e._updateTabStates.call(this),this},getSkippedSteps:function(){return this.data("skippedSteps")||[]},_updateTabStates:function(){var e=this.attr("id"),i=this.data("skippedSteps")||[];t("#"+e+"-titles").children().each((function(e){-1!==i.indexOf(e+1)?t(this).addClass("disabled-step").css({opacity:"0.5",cursor:"not-allowed"}):t(this).removeClass("disabled-step").css({opacity:"1",cursor:"pointer"})}))},_build:function(){var i=this,a=i.data("options"),s=i.attr("id"),n=t("<ul/>",{id:s+"-titles",class:"jsteps-titles"});a.titleTarget?t(a.titleTarget).html(n):n.insertBefore(i),a.validate&&(jQuery.validator.setDefaults({ignore:a.ignore}),i.append('<div class="jsteps-error"/>')),i.find(".finish").hide(),e._renderSteps.call(i)},_renderSteps:function(){var i=this,a=i.data("options"),s=i.attr("id"),n=i.children("fieldset"),r=t("#"+s+"-titles").empty();n.each((function(d){var l=t(this).addClass("step").attr("id",s+"-step-"+d);l.find("."+s+"-buttons").remove(),l.append('<p id="'+s+"-buttons-"+d+'" class="'+s+'-buttons"/>');var p=l.children("legend");a.legend||p.hide();var c="";a.description&&p.length&&(c="<span>"+p.html()+"</span>");var o,u=l.attr("title"),h=t("<li>"+(u=u?"<div>"+u+"</div>":"--")+c+"</li>").css("cursor","pointer").click((o=d,async function(){var n=o+1;if(-1!==(i.data("skippedSteps")||[]).indexOf(n))return!1;if(a.validate){var d=r.children(".current-step").index(),l=t("#"+s+"-step-"+d);if(l.length&&!l.find(":input").valid())return!1}e.step.call(i,n)}));r.append(h),0===d?n.length>1&&e.createNextButton.call(i,d):d===n.length-1?(e.createBackButton.call(i,d),l.hide()):(e.createBackButton.call(i,d),e.createNextButton.call(i,d),l.hide())})),r.children().first().addClass("current-step"),e._updateTabStates.call(i)},createBackButton:function(i){var a=this,s=a.attr("id"),n=a.data("options");t("<a/>",{href:"javascript:void(0);",class:"button-back",html:n.backLabel}).click((async function(){var t=await e._runCallback.call(a,n.back,i);if(!1!==t){for(var s="number"==typeof t?t:i,r=a.data("skippedSteps")||[];-1!==r.indexOf(s)&&s>1;)s--;e.step.call(a,s)}})).appendTo(t("#"+s+"-buttons-"+i))},createNextButton:function(i){var a=this,s=a.attr("id"),n=a.data("options");t("<a/>",{href:"javascript:void(0);",class:"button-next",html:n.nextLabel}).click((async function(){if(n.validate){var r=t("#"+s+"-step-"+i);if(t(".jsteps-error").empty(),!r.find(":input").valid())return!1}var d=await e._runCallback.call(a,n.next,i+2);!1!==d&&("number"==typeof d?e.step.call(a,d):e.step.call(a,i+2))})).appendTo(t("#"+s+"-buttons-"+i))},_runCallback:async function(t,e){if(!t)return!0;var i=t.call(this,e);return i instanceof Promise&&(i=await i),i},step:function(e){e--;var i=this.children("fieldset"),a=this.data("options"),s=this.attr("id");return e>i.length-1&&(e=i.length-1),e<0&&(e=0),i.hide().eq(e).show(),t("#"+s+"-titles").children().removeClass("current-step").eq(e).addClass("current-step"),e===i.length-1?this.find(".finish").show():this.find(".finish").hide(),a.select&&a.select.call(this,e+1),this},addStep:function(t,i){var a=this;return void 0===i?a.append(t):a.children("fieldset").eq(i).before(t),e._renderSteps.call(a),a},removeStep:function(t){var i=this;return i.children("fieldset").eq(t-1).remove(),e._renderSteps.call(i),i}};t.fn.jsteps=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist!"):e.init.apply(this,arguments)},t.fn.jsteps.defaults={back:void 0,backLabel:"&lt; Back",next:void 0,nextLabel:"Next &gt;",finish:void 0,validate:!1,legend:!0,description:!0,titleTarget:void 0,select:void 0,ignore:"",skipSteps:[]}}(jQuery);
